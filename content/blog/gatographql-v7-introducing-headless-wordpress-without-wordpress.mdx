---
title: "ğŸ‘¨ğŸ»â€ğŸ”§ Gato GraphQL v7.0: Headless WordPress without WordPress"
seoTitle: "ğŸ‘¨ğŸ»â€ğŸ”§ Gato GraphQL introduces Headless WordPress without WordPress"
description: 'With the latest version, it is possible to execute Gato GraphQL queries without initializing WordPress!'
seoDescription: 'With the latest version, it is possible to execute Gato GraphQL queries without initializing WordPress!'
publishedAt: '2024-11-06 09:00:00'
author: 'Leonardo Losoviz'
authorImg: '/images/leo-avatar.jpg'
tags:
  - product update
---

```php
<?php

declare(strict_types=1);

use GraphQLByPoP\GraphQLServer\Server\StandaloneGraphQLServer;
use PoP\Root\Container\ContainerCacheConfiguration;

require_once (__DIR__ . '/wordpress/wp-content/plugins/gatographql/vendor/scoper-autoload.php');
require_once (__DIR__ . '/wordpress/wp-content/plugins/gatographql-all-extensions-bundle/vendor/scoper-autoload.php');

$moduleClasses = [
  \PoPSchema\EnvironmentFields\Module::class,
  \PoPSchema\FunctionFields\Module::class,
  \GraphQLByPoP\ExportDirective\Module::class,
  \GraphQLByPoP\DependsOnOperationsDirective\Module::class,
  \GraphQLByPoP\RemoveDirective\Module::class,
  \PoPSchema\ApplyFieldDirective\Module::class,
  \PoPSchema\SendHTTPRequests\Module::class,
  \PoPSchema\ConditionalMetaDirectives\Module::class,
  \PoPSchema\DataIterationMetaDirectives\Module::class,
];

$moduleClassConfiguration = [
  \PoP\GraphQLParser\Module::class => [
    \PoP\GraphQLParser\Environment::ENABLE_MULTIPLE_QUERY_EXECUTION => true,
    \PoP\GraphQLParser\Environment::ENABLE_RESOLVED_FIELD_VARIABLE_REFERENCES => true,
    \PoP\GraphQLParser\Environment::ENABLE_COMPOSABLE_DIRECTIVES => true,
  ],
  \PoPSchema\SendHTTPRequests\Module::class => [
    \PoPSchema\SendHTTPRequests\Environment::SEND_HTTP_REQUEST_URL_ENTRIES => [
      '#https://api.github.com/repos/(.*)#',
    ],
  ],
  \PoPSchema\EnvironmentFields\Module::class => [
    \PoPSchema\EnvironmentFields\Environment::ENVIRONMENT_VARIABLE_OR_PHP_CONSTANT_ENTRIES => [
      'GITHUB_ACCESS_TOKEN',
    ],
  ],
];

$graphQLServer = new StandaloneGraphQLServer(
  $moduleClasses,
  $moduleClassConfiguration,
  [],
  [],
  new ContainerCacheConfiguration(
    'MyGraphQLServer',
    true,
    'query-github-repos',
    __DIR__ . '/tmp'
  )
);

$query = <<<GRAPHQL

  query RetrieveProxyArtifactDownloadURLs(
    $repoOwner: String!
    $repoProject: String!
    $perPage: Int = 1
    $artifactName: String = ""
  ) {
    githubAccessToken: _env(name: "GITHUB_ACCESS_TOKEN")
      # This directive will remove this entry from the output
      @remove

    # Create the authorization header to send to GitHub
    authorizationHeader: _sprintf(
      string: "Bearer %s"
      # "Field to Input" feature to access value from the field above
      values: [$__githubAccessToken]
    )
      # Do not print in output
      @remove

    # Create the authorization header to send to GitHub
    githubRequestHeaders: _echo(
      value: [
        { name: "Accept", value: "application/vnd.github+json" }
        { name: "Authorization", value: $__authorizationHeader }
      ]
    )
      # Do not print in output
      @remove
      @export(as: "githubRequestHeaders")

    githubAPIEndpoint: _sprintf(
      string: "https://api.github.com/repos/%s/%s/actions/artifacts?per_page=%s&name=%s"
      values: [$repoOwner, $repoProject, $perPage, $artifactName]
    )

    # Use the field from "Send HTTP Request Fields" to connect to GitHub
    gitHubArtifactData: _sendJSONObjectItemHTTPRequest(
      input: {
        url: $__githubAPIEndpoint
        options: { headers: $__githubRequestHeaders }
      }
    )
      # Do not print in output
      @remove

    # Finally just extract the URL from within each "artifacts" item
    gitHubProxyArtifactDownloadURLs: _objectProperty(
      object: $__gitHubArtifactData
      by: { key: "artifacts" }
    )
      @underEachArrayItem(passValueOnwardsAs: "artifactItem")
        @applyField(
          name: "_objectProperty"
          arguments: { object: $artifactItem, by: { key: "archive_download_url" } }
          setResultInResponse: true
        )
      @export(as: "gitHubProxyArtifactDownloadURLs")
  }

  query CreateHTTPRequestInputs
    @depends(on: "RetrieveProxyArtifactDownloadURLs")
  {
    httpRequestInputs: _echo(value: $gitHubProxyArtifactDownloadURLs)
      @underEachArrayItem(passValueOnwardsAs: "url")
        @applyField(
          name: "_objectAddEntry"
          arguments: {
            object: {
              options: { headers: $githubRequestHeaders, allowRedirects: null }
            }
            key: "url"
            value: $url
          }
          setResultInResponse: true
        )
      @export(as: "httpRequestInputs")
      @remove
  }

  query RetrieveActualArtifactDownloadURLs
    @depends(on: "CreateHTTPRequestInputs")
  {
    _sendHTTPRequests(inputs: $httpRequestInputs) {
      artifactDownloadURL: header(name: "Location")
        @export(as: "artifactDownloadURLs", type: LIST)
    }
  }

  query PrintSpaceSeparatedArtifactDownloadURLs
    @depends(on: "RetrieveActualArtifactDownloadURLs")
  {
    spaceSeparatedArtifactDownloadURLs: _arrayJoin(
      array: $artifactDownloadURLs
      separator: " "
    )
  }

GRAPHQL;

$variables = (object) [
  'repoOwner' => 'GatoGraphQL',
  'repoProject' => 'GatoGraphQL',
  'perPage' => 2
];

$response = $graphQLServer->execute(
  $query,
  $variables,
);
echo $response->getContent();

```